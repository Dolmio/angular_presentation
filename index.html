<!DOCTYPE html>
<html>
  <head>
    <title>Screenshots</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="css/style.css" type="text/css">
    <link rel="stylesheet" href="syntaxhighlighter/shThemeDefault.css" type="text/css">
    <script src="js/jquery-1.7.min.js"></script>
    <script src="js/angular-1.0.0rc8.min.js"></script>
    <script src="js/slidedeck.js"></script>
    <script src="js/dom.js"></script>
    <script src="js/presentation.js"></script>
    <script src="js/keyboard.js"></script>
    <script src="syntaxhighlighter/shCore.js"></script>
    <script src="syntaxhighlighter/shBrushJScript.js"></script>
    <script src="syntaxhighlighter/shBrushXml.js"></script>
    <script>
      SyntaxHighlighter.all();
      angular.module('AppModule',
        ['PresentationModule', 'KeyboardModule', 'SlideDeckModule']);
    </script>
  </head>
  <body
    ng-app="AppModule"
    ng-controller="PresentationController"
    keyboard-left="previous()"
    keyboard-right="next()"
    keyboard-pageUp="previous()"
    keyboard-pageDown="next()">

    <div id="intro">
      <h1>Screenshots</h1>
      <h2>
        Elliott Sprehn
      </h2>
      <h3 ng:hide="isInside()">
          <a href="http://elliottsprehn.com/@">@ElliottZ</a> /
          <a href="http://elliottsprehn.com/+">http://elliottsprehn.com/+</a>
      </h3>
    </div>

    <p id="counter" ng-show="isInside()">
      <a href="#/slides/1">&laquo;</a>
      {{activeSlide + 1}} / {{totalSlides}}
      <a href="#/slides/{{totalSlides}}">&raquo;</a>
    </p>

    <slide-deck current="activeSlide" total="totalSlides">

      <slide>
        <h2>What is Google Feedback ?</h2>
        <p>
          <img src="images/describe.png">
        </p>
      </slide>

      <slide>
        <h2>Screenshots in JavaScript (on the web)</h2>
        <p>
          <img src="images/preview.png" width="760">
        </p>
      </slide>

      <!--
        * Feedback is all about not asking users survey questions
        * Screenshot is super important
      -->
      <slide>
        <h2>Why screenshots</h2>
        <ul>
          <li>More useful feedback

          <li>Users write bad descriptions

          <li>Annotations show location of issues
        </ul>
      </slide>

      <!--
        * Google has complicated ACLs, server side rendering not easy
        * Blackout must be client side
        * Server side rendering = lots of resources
        * JS is cross platform
      -->
      <slide>
        <h2>Why client side</h2>
        <ul>
          <li>Privacy

          <li>Blackouts

          <li>Scalability

          <li>Cross platform
        </ul>
      </slide>

      <!--
        * Native API for screenshots
        * Users don't install things (or can't)
        * Getting users to update extensions is worse
        * Different JS for each browser extension, C++ for IE
      -->
      <slide>
        <h2>What about extensions</h2>
        <ul>
          <li>Angry users don't install things

          <li>Lots of browsers to support

          <li>Policies prevent installs
        </ul>
      </slide>

      <!--
        * Insecure domain so we can support untrusted user uploaded content
      -->
      <slide>
        <h2>Feedback internals</h2>
        <p>
          <img src="images/feedback-arch.png" height="550">
        </p>
      </slide>

      <!--
        * Clone the whole document
        * Make it stop changing
        * Lets user annotate
        * Stabilize rendering
        * "Frozen" appearance
      -->
      <slide>
        <h2>Clone the page</h2>
        <p>
          <img src="images/zombie-page.png" width="850">
        </p>
      </slide>

      <slide class="big-code">
        <h2>Measuring text</h2>
        <script type="syntaxhighlighter" slide-code>
          <p>
            <gft>Hello world.</gft>
          </p>
        </script>

        <h3>- OR -</h3>

        <script type="syntaxhighlighter" slide-code="js">
          var range = document.createRange();
          range.selectNode(textNode);
          var rect =
              range.getBoundingClientRect();
        </script>
      </slide>

      <slide>
        <h2>Proxy and serialize images</h2>
        <ul>
          <li>Proxy cross domain images

          <li>Use an iframe on the proxy domain

          <li>Serialize same domain images

          <li><code>postMessage()</code> data urls
        </ul>
      </slide>

      <!--
        * This is how we think of a page when authoring
        * Not how we think of it when styling
      -->
      <slide>
        <h2>Element tree</h2>
        <p>
          <img src="images/element-tree.png" height="550">
        </p>
      </slide>

      <!--
        * Separate renderers for different things: Frames, text, form controls,
        * Order of the tree can be different based on z-index and positioning
        * Collect commands with getBoundingClientRect offsetTop + offsetLeft
        * Gotcha: Apply offsets inside frames
      -->
      <slide>
        <h2>Render tree</h2>
        <p>
          <img src="images/render-tree.png" height="550">
        </p>
      </slide>

      <!--
        * Optimization: Only draw things inside the viewport
        * Small subset of the canvas API: drawText, drawRect, ...
      -->
      <slide>
        <h2>Create primitive commands</h2>
        <p>
          <img src="images/page-blocks.png" width="850">
        </p>
      </slide>

      <slide>
        <h2>Serialize commands</h2>
        <script type="syntaxhighlighter" slide-code="js">
          [
            {
              "command": "pushClip",
              "args": [0, 0, 8, 8]
            },
            {
              "command": "drawText",
              "args": [10, 10, "Hello World", "red"]
            },
            {
              "command": "drawRect",
              "args": [10, 10, 20, 20, "red", 2]
            }
          ]
        </script>
      </slide>

      <slide>
        <h2>Serialized commands (2)</h2>
        <script type="syntaxhighlighter" slide-code="js">
          [
            // Command 1 is pushClip
            [1, [0, 0, 8, 8]],

            // Command 10 is drawText
            [10, ["Hello World"]],

            // Command 13 is drawRect
            [13, [10, 10, 20, 20, "red", 2]],

            // Command 2 is popClip
            [2],
          ]
        </script>
      </slide>

      <slide>
        <h2>Optimize commands</h2>
        <script type="syntaxhighlighter" slide-code="js">
          [
            // Nothing to draw
          ]
        </script>
      </slide>


      <!--

      <slide class="interlude">
        <h2></h2>
        <h3>
          Okay, lets see some demos!
        </h3>
      </slide>
      -->

    </slide-deck>

  </body>
</html>